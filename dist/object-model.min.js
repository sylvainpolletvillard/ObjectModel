!function(a){function b(a){return"function"==typeof a}function c(a){return"object"==typeof a}function d(a,e){if(e&&(e.length>15||e.indexOf(a)>=0))return"...";if(null==a)return String(a);if("string"==typeof a)return'"'+a+'"';if(e=[a].concat(e),b(a))return a.name||a.toString(e);if(u(a))return"["+a.map(function(a){return d(a,e)}).join(", ")+"]";if(a&&c(a)){var f=new Array(e.length).join("	");return"{"+Object.keys(a).map(function(b){return"\n	"+f+b+": "+d(a[b],e)}).join(",")+"\n"+f+"}"}return String(a)}function e(a){return{}.toString.call(a).match(/\s([a-zA-Z]+)/)[1]}function f(a){return Array.prototype.slice.call(a)}function g(a,b,c){Object.keys(b||{}).forEach(function(d){if(c&&"Object"===e(b[d])){var f={};g(f,a[d],c),g(f,b[d],c),a[d]=f}else a[d]=b[d]})}function h(a,b){v||Object.defineProperty(a,"__proto__",{enumerable:!1,writable:!0,value:b})}function i(a,b,c){a.prototype=Object.create(b),a.prototype.constructor=c||a,h(a.prototype,b)}function j(a,b){Object.setPrototypeOf(a,b.prototype),Object.defineProperty(a,"constructor",{enumerable:!1,writable:!0,value:b})}function k(a){if(!l(a))return k.Object(a);var b=function(a){return b.validate(a),a};return j(b,k),b.definition=a,b.assertions=[],b}function l(a){return"Object"!=e(a)}function m(a){if(l(a)){if(!u(a))return[a];if(1===a.length)return a.concat(void 0)}else Object.keys(a).forEach(function(b){a[b]=m(a[b])});return a}function n(a,b,c,f){if(l(b)){b=m(b);for(var g=0,h=b.length;h>g;g++)if(o(a,b[g],f))return;throw new TypeError("expecting "+(c?c+" to be ":"")+b.map(function(a){return d(a)}).join(" or ")+", got "+(null!=a?e(a)+" ":"")+d(a))}Object.keys(b).forEach(function(d){var e=null!=a?a[d]:void 0;n(e,b[d],c?c+"."+d:d,f.concat(e))})}function o(a,c,d){if(null==a)return a===c;if(k.instanceOf(c,k)){var e=d.indexOf(c);return-1!==e&&-1!==d.slice(e+1).indexOf(c)?!0:c.test(a,d.concat(c))}return c instanceof RegExp?c.test(a):a===c||b(c)&&a instanceof c||a.constructor===c}function p(a,b){for(var c=0,e=b.length;e>c;c++)if(!b[c](a))throw new TypeError("an assertion of the model is not respected: "+d(b[c]))}function q(a,b,c,d){if(k.instanceOf(c,k)&&!k.instanceOf(b,c))return c(b);if(l(c))return b;var e=b instanceof Object?b:{},f=Object.create(Object.getPrototypeOf(e));for(var g in e)!e.hasOwnProperty(g)||g in c||(f[g]=e[g]);return Object.keys(c).forEach(function(g){var h=d?d+"."+g:g,i=k.conventionForConstant(g);Object.defineProperty(f,g,{get:function(){return q(a,e[g],c[g],h)},set:function(d){if(i&&void 0!==e[g])throw new TypeError("cannot redefine constant "+g);var f=q(a,d,c[g],h);n(f,c[g],h,[]);var j=e[g];e[g]=f;try{p(b,a.assertions)}catch(k){throw e[g]=j,k}},enumerable:!k.conventionForPrivate(g)})}),f}function r(a,b,c,d){Object.defineProperty(a,c,{enumerable:!0,get:function(){return b[c]},set:function(a){t(b,c,a,d)}})}function s(a,b,c,d){return function(){var e=a.slice();if(Array.prototype[b].apply(e,arguments),c.validate(e),!w)for(var f in e)!e.hasOwnProperty(f)||f in d||r(d,a,f,c);return Array.prototype[b].apply(a,arguments)}}function t(a,b,c,d){parseInt(b)===+b&&b>=0&&n(c,d.definition,"Array["+b+"]",[]);var e=a.slice();e[b]=c,p(e,d.assertions),a[b]=c}var u=function(a){return a instanceof Array},v=!!Object.setPrototypeOf||{__proto__:[]}instanceof Array;Object.setPrototypeOf=Object.setPrototypeOf||(v?function(a,b){a.__proto__=b}:function(a,b){for(var c in b)a[c]=b[c];h(a,b)}),Object.getPrototypeOf=Object.getPrototypeOf&&v?Object.getPrototypeOf:function(a){return a.__proto__||(a.constructor?a.constructor.prototype:null)};var w="function"==typeof Proxy;i(k,Function.prototype),k.prototype.toString=function(a){return d(this.definition,a)},k.prototype.validate=function(a,b){n(a,this.definition,void 0,b||[]),p(a,this.assertions)},k.prototype.test=function(a,b){try{return this.validate(a,b),!0}catch(c){return!1}},k.prototype.extend=function(){var a,b=f(arguments);k.instanceOf(this,k.Object)?(a={},g(a,this.definition),b.forEach(function(b){g(a,k.instanceOf(b,k)?b.definition:b,!0)})):a=b.reduce(function(a,b){return a.concat(m(b))},m(this.definition)).filter(function(a,b,c){return c.indexOf(a)===b});var c=new this.constructor(a);return i(c,this.prototype),c.assertions=f(this.assertions),c},k.prototype.assert=function(){return this.assertions=this.assertions.concat(f(arguments).filter(b)),this},k.instanceOf=function(a,b){return v?a instanceof b:function c(a,d){if(null==a||-1!==d.indexOf(a))return!1;var e=Object.getPrototypeOf(a);return d.push(a),e===b.prototype||c(e,d)}(a,[])},k.conventionForConstant=function(a){return a.toUpperCase()===a},k.conventionForPrivate=function(a){return"_"===a[0]},k.Object=function(a){var b=function(a){if(!(this instanceof b))return new b(a);g(this,a,!0);var c=q(b,this,b.definition);return b.validate(c),h(c,b.prototype),c};return j(b,k.Object),b.definition=a,b.assertions=[],b},i(k.Object,k.prototype,k),k.Object.prototype.defaults=function(a){return g(this.prototype,a),this};var x=["pop","push","reverse","shift","sort","splice","unshift"];k.Array=function(a){var b=function(a){var c;if(b.validate(a),w)c=new Proxy(a,{get:function(a,c){return x.indexOf(c)>=0?s(a,c,b):a[c]},set:function(a,c,d){t(a,c,d,b)}});else{c=Object.create(Array.prototype);for(var d in a)a.hasOwnProperty(d)&&r(c,a,d,b);Object.defineProperty(c,"length",{get:function(){return a.length}}),x.forEach(function(d){Object.defineProperty(c,d,{configurable:!0,value:s(a,d,b,c)})})}return j(c,b),c};return i(b,Array.prototype),j(b,k.Array),b.definition=a,b.assertions=[],b},i(k.Array,k.prototype,k),k.Array.prototype.validate=function(a){if(!u(a))throw new TypeError("expecting an array, got: "+d(a));for(var b=0,c=a.length;c>b;b++)n(a[b],this.definition,"Array["+b+"]",[]);p(a,this.assertions)},k.Array.prototype.toString=function(a){return"Model.Array("+d(this.definition,a)+")"},k.Function=function(){var a=function(b){var c=a.definition,e=function(){var e=[];if(g(e,c.defaults),g(e,f(arguments)),e.length!==c.arguments.length)throw new TypeError("expecting "+d(b)+" to be called with "+c.arguments.length+" arguments, got "+e.length);c.arguments.forEach(function(a,b){n(e[b],a,"arguments["+b+"]",[])}),p(e,a.assertions);var h=b.apply(this,e);return"return"in c&&n(h,c["return"],"return value",[]),h};return j(e,a),e};return i(a,Function.prototype),j(a,k.Function),a.definition={arguments:f(arguments)},a.assertions=[],a},i(k.Function,k.prototype,k),k.Function.prototype.validate=function(a){if(!b(a))throw new TypeError("expecting a function, got: "+d(a))},k.Function.prototype.toString=function(a){var b="Model.Function("+this.definition.arguments.map(function(b){return d(b,a)}).join(",")+")";return"return"in this.definition&&(b+=".return("+d(this.definition["return"])+")"),b},k.Function.prototype["return"]=function(a){return this.definition["return"]=a,this},k.Function.prototype.defaults=function(){return this.definition.defaults=f(arguments),this},a.Model=k}(this);